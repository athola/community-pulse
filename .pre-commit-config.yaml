default_language_version:
  python: python3

repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-merge-conflict
      - id: check-added-large-files

  - repo: local
    hooks:
      - id: uv-ruff
        name: ruff lint (uv env)
        entry: uv run ruff check src tests
        language: system
        pass_filenames: false

      - id: uv-ruff-format
        name: ruff format (uv env)
        entry: uv run ruff format src tests
        language: system
        pass_filenames: false
        stages: [manual]

      - id: uv-mypy
        name: mypy (uv env)
        entry: uv run mypy src tests
        language: system
        pass_filenames: false

      - id: uv-pytest
        name: pytest (uv env)
        entry: uv run pytest
        language: system
        pass_filenames: false
        stages: [pre-push]

      - id: mobile-lint-if-present
        name: mobile lint (if mobile exists)
        entry: bash -c 'DIR=${MOBILE_DIR:-mobile}; if [ -d "$DIR" ]; then cd "$DIR" && npm run lint --silent; else echo "mobile directory missing; skipping"; fi'
        language: system
        pass_filenames: false

      - id: mobile-test-if-present
        name: mobile tests (if mobile exists)
        entry: bash -c 'DIR=${MOBILE_DIR:-mobile}; if [ -d "$DIR" ]; then cd "$DIR" && npm test --silent; else echo "mobile directory missing; skipping"; fi'
        language: system
        pass_filenames: false
        stages: [pre-push]
